<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to bain • bain</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to bain">
<meta property="og:description" content="bain">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bain</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction_to_bain.html">Introduction to bain</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cjvanlissa/bain/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Introduction_to_bain_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to bain</h1>
                        <h4 class="author">Herbert Hoijtink, Caspar van Lissa, Joris Mulder, Xin Gu</h4>
            
            <h4 class="date">2021-11-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cjvanlissa/bain/blob/master/vignettes/Introduction_to_bain.Rmd"><code>vignettes/Introduction_to_bain.Rmd</code></a></small>
      <div class="hidden name"><code>Introduction_to_bain.Rmd</code></div>

    </div>

    
    
<div id="acknowledgement" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgement" class="anchor"></a>Acknowledgement</h2>
<p>Besides the authors Marlyne Bosman, Camiel van Zundert, and Fayette Klaassen have contributed examples to this vignette.</p>
</div>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p><code>bain</code> is an acronym for “Bayesian informative hypotheses evaluation”. It uses the Bayes factor to evaluate hypotheses specified using equality and inequality constraints among (linear combinations of) parameters in a wide range of statistical models.</p>
<p>Two tutorials are retrievable from the bain website (look under tutorials) at <a href="https://informative-hypotheses.sites.uu.nl/software/bain/" class="uri">https://informative-hypotheses.sites.uu.nl/software/bain/</a>.</p>
<p>The first introducing Bayesian evaluation of informative hypotheses is provided by Hoijtink, H., Mulder, J., van Lissa, C., and Gu, X. (2019). A tutorial on testing hypotheses using the Bayes factor. Psychological Methods, 24, 539-556. By reading the tutorial in combination with executing the analyses contained in <code>easyBFtutorial.R</code> and <code>BFtutorial.R</code> you quickly learn the basics of Bayesian hypothesis evaluation.</p>
<p>The second containing introduction to Bayesian evaluation of informative hypotheses in the context of structural equation models is provided by Van Lissa, C., Gu, X., Mulder, J., Rosseel, Y., van Zundert, C. and Hoijtink, H. (2020), Structural Equation Modeling, 28, 292-301.</p>
<p><strong>Users are advised to read these tutorials and this vignette before using <code>bain</code></strong>.</p>
<p>The full <code>bain</code> reference list with applications and statistical underpinnings can be found on the <code>bain</code> website.</p>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p><code><a href="../reference/bain.html">bain(x, hypothesis, fraction = 1, ...)</a></code></p>
</div>
<div id="arguments" class="section level2">
<h2 class="hasAnchor">
<a href="#arguments" class="anchor"></a>Arguments</h2>
<p><code>x</code> An R object containing the outcome of a statistical analysis. Currently, the following objects can be processed:</p>
<ol style="list-style-type: decimal">
<li>
<code><a href="../reference/t_test.html">t_test()</a></code> objects (Student’s t-test, Welch’s t-test, paired samples t-test, one-group t-test, equivalence test). Note that, <code>t_test</code> can be used in the same way as <code>t.test</code>.</li>
<li>
<code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> objects (ANOVA, ANCOVA, multiple regression).</li>
<li>
<code>lavaan</code> objects generated with the <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem()</a></code>, <code><a href="https://rdrr.io/pkg/lavaan/man/cfa.html">cfa()</a></code>, and <code>growth</code> functions.</li>
<li>A named vector containing the estimates resulting from a statistical analysis. Using this option triggers the <code>bain.default()</code> method. Note that, named means that each estimate has to be named such that it can be referred to in hypotheses.</li>
</ol>
<p><code>hypothesis</code> A character string containing the informative hypotheses to evaluate (see below the section on “The Specification of Hypotheses”).</p>
<p><code>fraction = 1</code> A number representing the fraction of information in the data used to construct the prior distribution. The default value 1 denotes the minimal fraction, 2 denotes twice the minimal fraction, etc. Example 2d. below shows how <code>fraction</code> can be employed to execute a sensitivity analysis. See also Hoijtink, Mulder, van Lissa, and Gu, 2019).</p>
<p><code>...</code> Additional arguments (see below).</p>
</div>
<div id="using-bain-with-a-lm-or-t_test-object" class="section level2">
<h2 class="hasAnchor">
<a href="#using-bain-with-a-lm-or-t_test-object" class="anchor"></a>Using <code>bain</code> with a <code>lm</code> or <code>t_test</code> object</h2>
<p>The following steps need to be executed:</p>
<ol style="list-style-type: decimal">
<li>
<code>x &lt;- lm()</code> or <code>x &lt;- t_test()</code>. Execute an analysis with <code>lm</code> or <code>t_test</code>. See the Examples section below for a complete elaboration of the calls to <code>lm</code> and <code>t_test</code> that can be processed by <code>bain</code>. Note that, <code>lm</code> and <code>t_test</code> will apply list-wise deletion if there are cases with missing values in the variables used. An imputation based method for dealing with missing values tailored to Bayesian hypothesis evaluation is illustrated in Section 2 “Examples Using a <code>lm</code> object” in Example e. (based on Hoijtink, Gu, Mulder, and Rosseel, 2019).</li>
<li>If <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> is used, display the estimates and their names using the command <code><a href="https://rdrr.io/r/stats/coef.html">coef(x)</a></code>. (Unique abbreviations of) the names will be used to specify <code>hypotheses</code>. If <code><a href="../reference/t_test.html">t_test()</a></code> is used, hypotheses have to be specified using the names <code>x</code>, <code>y</code>, and <code>difference</code> (see Examples 1a through 1e which can be found below).</li>
<li>
<code><a href="https://rdrr.io/r/base/Random.html">set.seed(seed)</a></code>. Set <code>seed</code> equal to an integer number to create a repeatable random number sequence. <code>bain</code> uses sampling to compute Bayes factors and posterior model probabilities. It is therefore recommended to run analyses with two different seeds to ensure stability of the results.</li>
<li>
<code>results &lt;- bain(x,hypotheses,fraction = 1)</code> or <code>results &lt;- bain(x,hypotheses,fraction = 1,standardize = FALSE)</code>. The first call to <code>bain</code> is used in case of <code>lm</code> implementations of ANOVA, ANCOVA, and <code>t_test</code>. The second call to <code>bain</code> is used in case of <code>lm</code> implementations of multiple regression. With <code>standardize = TRUE</code> hypotheses with respect to standardized regression coefficients are evaluated. With <code>standardize = FALSE</code> hypotheses with respect to unstandardized regression coefficients are evaluated. <code>fraction = 1</code> represents the fraction of information in the data used to construct the prior distribution. The default value 1 denotes the minimal fraction, 2 denotes twice the minimal fraction, etc. Example 2d. below shows how <code>fraction</code> can be employed to execute a sensitivity analysis. See also Hoijtink, Mulder, van Lissa, and Gu, 2019).</li>
<li>
<code><a href="https://rdrr.io/r/base/print.html">print(results)</a></code> Print the results of an analysis with <code>bain</code>.</li>
<li>
<code><a href="https://rdrr.io/r/base/summary.html">summary(results, ci=0.95)</a></code> Present estimates and credibility intervals for the parameters used to specify the <code>hypotheses</code>. <code>ci</code> can be used to specify the confidence level of the credibility intervals.</li>
</ol>
</div>
<div id="using-bain-with-a-lavaan-object" class="section level2">
<h2 class="hasAnchor">
<a href="#using-bain-with-a-lavaan-object" class="anchor"></a>Using <code>bain</code> with a <code>lavaan</code> object</h2>
<p>The following steps need to be executed:</p>
<ol style="list-style-type: decimal">
<li>
<code>x &lt;- sem()</code> or <code>x &lt;- cfa()</code> or <code>x &lt;- growth()</code>. Execute an analysis with the sem, cfa, or growth functions implemented in <a href="https://lavaan.ugent.be"><code>lavaan</code></a>. Note that, by default, <code>lavaan</code> will apply list-wise deletion if there are cases with missing values in the variables used. An imputation based method for dealing with missing values tailored to Bayesian hypothesis evaluation is illustrated in Section 2 “Examples Using a <code>lm</code> object” in Example e. (based on Hoijtink, Gu, Mulder, and Rosseel, 2019). If an analysis with <code>lavaan</code> is executed using <code>missing = "fiml"</code> the sample size is not corrected for the presence of missing values. This will affect (bias) the evaluation of hypotheses specified using (about) equality constraints.<br>
</li>
<li>Specify a <code>lavaan</code> model using the <code>model &lt;- ...</code> command. In case of multiple group models, only models <strong>without</strong> between group restrictions can be processed by <code>bain</code> with a <code>lavaan</code> object as input.</li>
<li>Display the estimates and their names using the command <code><a href="https://rdrr.io/r/stats/coef.html">coef(x)</a></code>. Only parameters who’s names contain <code><a href="https://rdrr.io/r/base/tilde.html">~</a></code> (regression coefficients), <code>~1</code> (intercepts), or <code>=~</code> (factor loadings) can be used in the specification of hypotheses. (Unique abbreviations of) the names can be used to specify <code>hypotheses</code>. For multiple group analyses the names have to end with a group label <code>.grp</code>. Group labels can be assigned using commands like <code>sesamesim$sex &lt;- factor(sesamesim$sex, labels = c("boy", "girl"))</code>. If in a <code>lavaan</code> model parameters are labeled, e.g., as in <code>model &lt;- 'age ~ c(a1, a2)*peabody + c(b1, b2)*1</code> then the labels have to be used in the specification of hypotheses.</li>
<li>
<code><a href="https://rdrr.io/r/base/Random.html">set.seed(seed)</a></code>. Set <code>seed</code> equal to an integer number to create a repeatable random number sequence. <code>bain</code> uses sampling to compute Bayes factors and posterior model probabilities. It is therefore recommended to run analyses with two different seeds to ensure stability of the results.</li>
<li>
<code>results &lt;- bain(x,hypotheses,fraction = 1,standardize = FALSE)</code>. With <code>standardize = TRUE</code> hypotheses with respect to standardized coefficients are evaluated. With <code>standardize = FALSE</code> hypotheses with respect to unstandardized coefficients are evaluated. <code>fraction = 1</code> represents the fraction of information in the data used to construct the prior distribution. The default value 1 denotes the minimal fraction, 2 denotes twice the minimal fraction, etc. Example 2d. below shows how <code>fraction</code> can be employed to execute a sensitivity analysis. See also Hoijtink, Mulder, van Lissa, and Gu, 2019).</li>
<li>
<code><a href="https://rdrr.io/r/base/print.html">print(results)</a></code> Print the results of an analysis with <code>bain</code>.</li>
<li>
<code><a href="https://rdrr.io/r/base/summary.html">summary(results, ci=0.95)</a></code> Present estimates and credibility intervals for the parameters used to specify the <code>hypotheses</code>. <code>ci</code> can be used to specify the confidence level of the credibility intervals.</li>
</ol>
</div>
<div id="using-bain-with-a-named-vector" class="section level2">
<h2 class="hasAnchor">
<a href="#using-bain-with-a-named-vector" class="anchor"></a>Using <code>bain</code> with a named vector</h2>
<p>The following steps need to be executed:</p>
<ol style="list-style-type: decimal">
<li>Execute a statistical analysis.</li>
</ol>
<p>In case of a single group analysis, the following information has to be extracted from the statistical analysis and supplied to <code>bain</code>:</p>
<ol style="list-style-type: lower-alpha">
<li>A vector containing estimates of the parameters used to specify <code>hypotheses</code>;</li>
<li>A list containing the covariance matrix of these parameters; and,</li>
<li>The sample size used for estimation of the parameters. Note that, due to missing values this sample size may be smaller than the total sample size. An imputation based method for dealing with missing values tailored to Bayesian hypothesis evaluation is illustrated in Section 2 “Examples Using a <code>lm</code> object” in Example e. (based on Hoijtink, Gu, Mulder, and Rosseel, 2019).</li>
</ol>
<p>In case of a multiple group analysis, the following information has to be extracted from the statistical analysis and supplied to <code>bain</code>:</p>
<ol style="list-style-type: lower-alpha">
<li>A vector containing estimates of the group specific parameters possibly augmented with the estimates of parameters that are shared by the groups. The structure of this vector is [parameters of group 1, parameters of group 2, …, the parameters that are shared by the groups];</li>
<li>A list containing, per group, the covariance matrix of the parameters corresponding to the group at hand and, possibly, the augmented parameters. In the rows and columns of each covariance matrix the parameters of the group at hand come first, possibly followed by the augmented parameters.</li>
<li>Per group the sample size used for estimation of the parameters. Note that, due to missing values this sample size may be smaller than the total sample size per group. An imputation based method for dealing with missing values tailored to Bayesian hypothesis evaluation is illustrated in Section 2 “Examples Using a <code>lm</code> object” in Example e. (based on Hoijtink, Gu, Mulder, and Rosseel, 2019).</li>
</ol>
<ol start="2" style="list-style-type: decimal">
<li>Assign names to the estimates using <code>names(estimates)&lt;-c()</code>. Note that, <code>names</code> is a character vector containing new names for the estimates in <code>estimates</code>. Each name has to start with a letter, and may consist of “letters”, “numbers”, “<code>.</code>”, “<code>_</code>”, “<code><a href="https://rdrr.io/r/base/Colon.html">:</a></code>”, “<code><a href="https://rdrr.io/r/base/tilde.html">~</a></code>”, “<code>=~</code>”, and “<code>~1</code>”. These names are used to specify <code>hypotheses</code> (see below). An example is <code>names &lt;- c("a", "b", "c")</code>.</li>
<li>
<code><a href="https://rdrr.io/r/base/Random.html">set.seed(seed)</a></code>. Set <code>seed</code> equal to an integer number to create a repeatable random number sequence. <code>bain</code> uses sampling to compute Bayes factors and posterior model probabilities. It is therefore recommended to run analyses with two different seeds to ensure stability of the results.</li>
<li>
<code>results &lt;- bain(estimates, hypotheses, n=., Sigma=., group_parameters = 2, joint_parameters = 0, fraction = 1)</code> executes <code>bain</code> with the following arguments:</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>
<code>estimates</code> A named vector with parameter estimates.</li>
<li>
<code>hypotheses</code> A character string containing the informative hypotheses to evaluate (the specification is elaborated below).</li>
<li>
<code>n</code> A vector containing the sample size of each group in the analysis. See, Hoijtink, Gu, and Mulder (2019), for an elaboration of the difference between one and multiple group analyses. A multiple group analysis is required when group specific parameters are used to formulate <code>hypotheses</code>. Examples are the Student’s and Welch’s t-test, ANOVA, and ANCOVA. See the Examples section for elaborations of the specification of multiple group analyses when a named vector is input for <code>bain</code>.</li>
<li>
<code>Sigma</code> A list of covariance matrices. In case of one group analyses the list contains one covariance matrix. In case of multiple group analyses the list contains one covariance matrix for each group. See the Examples section and Hoijtink, Gu, and Mulder (2019) for further instructions.</li>
<li>
<code>group_parameters</code> The number of group specific parameters. In, for example, an ANOVA with three groups, <code>estimates</code> will contain three sample means, <code>group_parameters = 1</code> because each group is characterized by one mean, and <code>joint_parameters = 0</code> because there are no parameters that apply to each of the groups. In, for example, an ANCOVA with three groups and two covariates, <code>estimates</code> will contain five parameters (first the three adjusted means, followed by the regression coefficients of the two covariates), <code>group_parameters = 1</code> because each group is characterized by one adjusted mean, and <code>joint_parameters = 2</code> because there are two regression coefficients that apply to each group. In, for example, a repeated measures design with four repeated measures and two groups (a between factor with two levels and a within factor with four levels) <code>estimates</code> will contain eight means (first the four for group 1, followed by the four for group 2), <code>group_parameters = 4</code> because each group is characterized by four means and <code>joint_parameters = 0</code> because there are no parameters that apply to each of the groups.</li>
<li>
<code>joint_parameters</code> In case of one group <code>joint_parameters = 0</code>. In case of two or more groups, the number of parameters in <code>estimates</code> shared by the groups. In, for example, an ANCOVA, the number of <code>joint_parameters</code> equals the number of covariates.</li>
<li>
<code>fraction = 1</code> A number representing the fraction of information in the data used to construct the prior distribution. The default value 1 denotes the minimal fraction, 2 denotes twice the minimal fraction, etc. Example 2d. below shows how <code>fraction</code> can be employed to execute a sensitivity analysis. See also Hoijtink, Mulder, van Lissa, and Gu, 2019).</li>
</ol>
<ol start="5" style="list-style-type: decimal">
<li>
<code><a href="https://rdrr.io/r/base/print.html">print(results)</a></code> Print the results of an analysis with <code>bain</code>.</li>
<li>
<code><a href="https://rdrr.io/r/base/summary.html">summary(results, ci=0.95)</a></code> Present estimates and credibility intervals for the parameters used to specify the <code>hypotheses</code>. <code>ci</code> can be used to specify the confidence level of the credibility intervals.</li>
</ol>
</div>
<div id="the-specification-of-hypotheses" class="section level2">
<h2 class="hasAnchor">
<a href="#the-specification-of-hypotheses" class="anchor"></a>The specification of <code>hypotheses</code>
</h2>
<p><code>hypotheses</code> is a character string that specifies which informative hypotheses have to be evaluated. A simple example is <code>hypotheses &lt;- "a &gt; b &gt; c; a = b = c;"</code> which specifies two hypotheses using three estimates with names “a”, “b”, and “c”, respectively.</p>
<p>The hypotheses specified have to adhere to the following rules:</p>
<ul>
<li>When using <code>bain</code> with a <code>lm</code> or <code>t_test</code> or <code>lavaan</code> object, (unique abbreviations of) the names displayed by <code><a href="https://rdrr.io/r/stats/coef.html">coef(x)</a></code> have to be used (but see the section “Using bain with a lavaan object” for additional instructions if multiple group analyses are executed and/or parameters are labeled). If, for example, the names are <code>cat</code> and <code>dog</code>, <code>c</code> and <code>d</code> would be unique abbreviations. If, for example, the names are <code>cato</code> and <code>cata</code> the whole names have to be used.</li>
<li>When using <code>bain</code> with a named vector, parameters are referred to using the names specified in <code><a href="https://rdrr.io/r/base/names.html">names()</a></code>.</li>
<li>Linear combinations of parameters must be specified adhering to the following rules:</li>
</ul>
<ol style="list-style-type: lower-alpha">
<li><p>Each parameter name is used at most once.</p></li>
<li><p>Each parameter name may or may not be pre-multiplied with a number.</p></li>
<li><p>A constant may be added or subtracted from each parameter name.</p></li>
<li>
<p>A linear combination can also be a single number.</p>
<p>Examples are: <code>3 * a + 5</code>; <code>a + 2 * b + 3 * c - 2</code>; <code>a - b</code>; and <code>5</code>.</p>
</li>
</ol>
<ul>
<li>(Linear combinations of) parameters can be constrained using &lt;, &gt;, and =. For example, <code>a &gt; 0</code> or <code>a &gt; b = 0</code> or <code>2 * a &lt; b + c &gt; 5</code>.</li>
<li>The ampersand <code><a href="https://rdrr.io/r/base/Logic.html">&amp;</a></code> can be used to combine different parts of a hypothesis. For example, <code>a &gt; b &amp; b &gt; c</code> which is equivalent to <code>a &gt; b &gt; c</code> or <code>a &gt; 0 &amp; b &gt; 0 &amp; c &gt; 0</code>.</li>
<li>Sets of (linear combinations of) parameters subjected to the same constraints can be specified using (). For example, <code>a &gt; (b,c)</code> which is equivalent to <code>a &gt; b &amp; a &gt; c</code>.</li>
<li>The specification of a hypothesis is completed by typing ; For example, <code>hypotheses &lt;- "a &gt; b &gt; c; a = b = c;"</code>, specifies two hypotheses.</li>
<li>Hypotheses have to be compatible, non-redundant and possible. What these terms mean will be elaborated below.</li>
</ul>
<p><strong>The set of hypotheses has to be compatible.</strong> For the statistical background of this requirement see Gu, Mulder, Hoijtink (2019). Usually the sets of hypotheses specified by researchers are compatible, and if not, <code>bain</code> will return an error message. The following steps can be used to determine if a set of hypotheses is compatible:</p>
<ol style="list-style-type: decimal">
<li>Replace a range constraint, e.g., <code>1 &lt; a1 &lt; 3</code>, by an equality constraint in which the parameter involved is equated to the midpoint of the range, that is, <code>a1 = 2</code>.</li>
<li>Replace in each hypothesis the &lt; and &gt; by =. For example, <code>a1 = a2 &gt; a3 &gt; a4</code> becomes <code>a1 = a2 = a3 = a4</code>.</li>
<li>The hypotheses are compatible if there is at least one solution to the resulting set of equations. For the two hypotheses considered under 1. and 2., the solution is <code>a1 = a2 = a3 = a4 = 2</code>. An example of two non-compatible hypotheses is <code>hypotheses &lt;- "a = 0; a &gt; 2;"</code> because there is no solution to the equations <code>a=0</code> and <code>a=2</code>.</li>
</ol>
<p><strong>Each hypothesis in a set of hypotheses has to be non-redundant.</strong> A hypothesis is redundant if it can also be specified with fewer constraints. For example, <code>a = b &amp; a &gt; 0 &amp; b &gt; 0</code> is redundant because it can also be specified as <code>a = b &amp; a &gt; 0</code>. <code>bain</code> will work correctly if hypotheses specified using only &lt; and &gt; are redundant. <code>bain</code> will return an error message if hypotheses specified using at least one = are redundant.</p>
<p><strong>Each hypothesis in a set of hypotheses has to be possible.</strong> An hypothesis is impossible if estimates in agreement with the hypothesis do not exist. For example: values for <code>a, b, c</code> in agreement with <code>a &gt; b &gt; c &amp; a &lt; c</code> do not exist. It is the responsibility of the user to ensure that the hypotheses specified are possible. If not, <code>bain</code> will either return an error message or render an output table containing <code>Inf</code>’s.</p>
</div>
<div id="output-from-an-analysis-with-bain" class="section level2">
<h2 class="hasAnchor">
<a href="#output-from-an-analysis-with-bain" class="anchor"></a>Output from an analysis with <code>bain</code>
</h2>
<p>The commands <code><a href="../reference/bain.html">bain()</a></code> or <code>results&lt;-bain()</code> followed by <code>results</code> or <code><a href="https://rdrr.io/r/base/print.html">print(results)</a></code> will render the default (most important) output from <code>bain</code>. These concern for each hypothesis specified in <code>hypotheses</code> the fit, complexity, Bayes factor versus the unconstrained hypothesis, Bayes factor versus its complement, posterior model probability (based on equal prior model probabilities) excluding the unconstrained hypothesis, posterior model probability including the unconstrained hypothesis, and posterior model probability of each hypothesis specified and their joint complement. Note that, all the posterior model probabilities are computed from the Bayes factors of each hypothesis versus the unconstrained hypothesis. In Hoijtink, Mulder, van Lissa, and Gu (2019) it is elaborated how these quantities (and the other output presented below) should be interpreted. Additionally, using <code><a href="https://rdrr.io/r/base/summary.html">summary(results, ci=0.95)</a></code>, a descriptives matrix can be obtained in which for each estimate, the name, the value, and a 95% central credibility interval is presented.</p>
<p>The following commands can be used to retrieve the default and additional information from the <code>bain</code> output object:</p>
<ul>
<li>
<code>results$fit</code> renders the default output, <code>results$fit$Fit</code> contains only the column containing the fit of each hypothesis. In the last command <code>Fit</code> can be replaced by <code>Com</code>, <code>BF</code>, <code>BF.u</code>, <code>BF.c</code>, <code>PMPa</code>, <code>PMPb</code>, <code>PMPc</code> to obtain the information in the corresponding columns of the default output. Note that, in the columns <code>BF</code> and <code>BF.c</code> the Bayes factor of the hypothesis at hand versus its complement is displayed. In the column <code>BF.u</code> the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis is displayed. <code>PMPa</code> renders the posterior model probabilities (based on equal prior model probabilities) of the hypotheses specified. <code>PMPb</code> renders the posterior model probabilities (based on equal prior model probabilities) of the hypotheses specified plus the unconstrained hypothesis. <code>PMPc</code> renders the posterior model probabilities (based on equal prior model probabilities) of the hypotheses specified plus the complement of the union of these hypotheses. If, in the latter case, the complexity of the complement of the union of all hypotheses specified is smaller than .05, the hypotheses specified (almost) completely cover the parameter space. In this case <code>PMPc</code> is not provided and instead <code>PMPa</code> should be used.</li>
<li>
<code>results$BFmatrix</code> contains the matrix containing the mutual Bayes factors of the hypotheses specified in <code>hypotheses</code>.</li>
<li>
<code>results$b</code> contains for each of the groups in the analysis the fraction of information of the data in the group at hand used to specify the covariance matrix of the prior distribution.</li>
<li>
<code>results$prior</code> contains the covariance matrix of the prior distribution.</li>
<li>
<code>results$posterior</code> contains the covariance matrix of the posterior distribution.</li>
<li>
<code>results$call</code> displays the call to <code>bain</code>.</li>
<li>
<code>results$model</code> displays the named vector or the R object that is input to <code>bain</code>.</li>
<li>
<code>results$n</code> displays the sample sizes per group.</li>
<li>
<code>results$independent_restrictions</code> displays the number of independent constraints in the set of hypotheses under consideration. Note that, in Gu, Mulder, and Hoijtink (2018) en Hoijtink, Gu, and Mulder (2019) the definition given was misprinted (besides R and S also r and s should have been added to the definition).</li>
<li>
<code>results$fit$Fit_eq</code> displays the fit of the equality constrained part of each hypothesis. Replacing <code>Fit_eq</code> by <code>Fit_in</code>, renders the fit of the inequality constrained part of an hypothesis conditional on the fit of the equality constrained part. <code>Com_eq</code>, and <code>Com_in</code>, respectively, are the complexity counterparts of <code>Fit_eq</code>, and <code>Fit_in</code>.</li>
</ul>
<p>Note that, if you have specified two hypotheses that both have a small <code>BF.u</code> (close to zero), then there is no support in the data for these hypotheses. In these cases the corresponding entry in <code>results$BFmatrix</code> (the Bayes factor comparing both hypotheses) is very unstable and should only be interpreted if repeated analyses using different seeds (see <code><a href="https://rdrr.io/r/base/Random.html">set.seed()</a></code>) render about the same results.</p>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<p>Note that, each of the examples given below can be run by 1) copy pasting them into the Source screen of <code>RStudio</code>. 2) by highlighting them followed by <code>ctrl-enter</code> or <code>cmd-enter</code>.</p>
<p>Unless indicated otherwise, the examples that follow below use a simulated data set inspired by the Sesame Street data set from: Stevens, J. P. (1996). Applied Multivariate Statistics for the Social Sciences. Mahwah NJ: Lawrence Erlbaum. This data set is included in the bain package. The variables contained in sesamesim are subsequently:</p>
<ul>
<li>sex (1 = boy, 2 = girl) of the child</li>
<li>site (1 = disadvantaged inner city, 2 = advantaged suburban , 3 = advantaged rural, 4 = disadvantaged rural, 5 = disadvantaged Spanish speaking) from which the child originates</li>
<li>setting (1 = at home, 2 = at school) in which the child watches sesame street</li>
<li>age (in months) of the child</li>
<li>viewenc (0 = no, 1 = yes), whether or not the child is encouraged to watch Sesame Street</li>
<li>peabody (mental age) score of the child (higher score is higher mental age)</li>
<li>prenumb (score on a numbers test before watching Sesame Street for a year)</li>
<li>postnumb (score on a numbers test after watching Sesame Street for a year)</li>
<li>funumb (follow up numbers test score measured one year after postnumb)</li>
<li>Bb Knowledge of body parts before</li>
<li>Bl Knowledge of letters before</li>
<li>Bf Knowledge of forms before</li>
<li>Bn Knowledge of numbers before</li>
<li>Br Knowledge of relations before</li>
<li>Bc Knowledge of classifications before</li>
<li>Ab Knowledge of body parts after</li>
<li>Al Knowledge of letters after</li>
<li>Af Knowledge of forms after</li>
<li>An Knowledge of numbers after</li>
<li>Ar Knowledge of relations after</li>
<li>Ac Knowledge of classifications after</li>
</ul>
<p>The examples that follow below are organized in four categories:</p>
<ol style="list-style-type: decimal">
<li>running <code>bain</code> with a <code>t_test</code> object</li>
<li>running <code>bain</code> with a <code>lm</code> object</li>
<li>running <code>bain</code> with a <code>lavaan</code> object</li>
<li>running bain with a named vector</li>
</ol>
<p>The ANOVA and ANCOVA examples are provided using both a <code>lm</code> object and a named vector as input for <code>bain</code>. Below you will find the following examples:</p>
<p><strong>1. Examples Using a <code>t_test</code> Object</strong></p>
<p>If a <code>t_test</code> object is used, the main output table is labeled: “Bayesian informative hypothesis testing for an object of class t_test” (which denotes that a <code>t-test</code> was executed).</p>
<ol style="list-style-type: lower-alpha">
<li>Bayesian Student’s t-test (equal within group variances)</li>
<li>Bayesian Welch’s t-test (unequal within group variances</li>
<li>Bayesian paired samples t-test</li>
<li>Bayesian one group t-test</li>
<li>Bayesian Equivalence test</li>
</ol>
<p><strong>2. Examples Using a <code>lm</code> Object</strong></p>
<ol style="list-style-type: lower-alpha">
<li>Bayesian ANOVA. The example concerns a one-way ANOVA. Two-way or higher order ANOVAs can only be handled by recoding all factors into one factor. If, for example, there is a factor <code>sex</code> with levels <code>man</code> and <code>woman</code>, and a factor <code>age</code> with levels <code>young</code> and <code>old</code>, these have to be recoded in a new factor <code>sexage</code> with levels <code>manyoung</code>, <code>manold</code>, <code>womanyoung</code>, <code>womanold</code>. If a <code>lm</code> “ANOVA” object is used, the main output table is labeled: “Bayesian informative hypothesis testing for an object of class lm (ANOVA)”</li>
<li>Bayesian ANCOVA. The example concerns a one-way ANCOVA. Two-way or higher order ANCOVAs can only be handled by recoding all factors into one factor. <strong>Note that calls to <code>lm</code> using functions of the predictors (for example, adding squared predictors to the model using commands like <code>y ~ x + I(x^2)</code>) can not be processed by <code>bain</code>.</strong> However, one can compute a new variable (for example, a squared predictor) and add this variable to the model specification of <code>lm</code>. If a <code>lm</code> “ANCOVA” object is used, the main output table is labeled: “Bayesian informative hypothesis testing for an object of class lm (ANCOVA)”. <strong>Note that, in the ANCOVA the covariates are centered!</strong>
</li>
<li>Bayesian multiple regression. <strong>Note that calls to <code>lm</code> using functions of the predictors (for example, adding squared predictors to the model using commands like <code>y ~ x + I(x^2)</code>) can not be processed by <code>bain</code>.</strong> However, one can compute a new variable (for example, a squared predictor) and add this variable to the model specification of <code>lm</code>. Note furthermore, that only if <code>standardize = FALSE</code> interactions between predictors should be processed, because a standardized interaction is not the same as the interaction between two standardized variables. If a <code>lm</code> “regression with only continuous predictors” object is used, the main output table is labeled: “Bayesian informative hypothesis testing for an object of class lm (continuous predictors)”. If a <code>lm</code> object contains <strong>two or more</strong> factors and, optionally, continuous predictors, the main output table is labeled: “Bayesian informative hypothesis testing for an object of class lm (mixed predictors)”. In case of mixed predictors, the one group approach to computing Bayes factors is used (see, Hoijtink, Gu, and Mulder, 2019). This may render inferior results if group sizes are unequal.</li>
<li>Bayesian ANOVA. Sensitivity analysis. See Hoijtink, Mulder, van Lissa, and Gu (2019) for elaborations.</li>
<li>Bayesian multiple regression with missing data</li>
</ol>
<p><strong>3. Examples Using a <code>lavaan</code> Object</strong></p>
<p>If a <code>lavaan</code> object is used, the main output table is labeled: “Bayesian informative hypothesis testing for an object of class lavaan”. See the tutorial by Van Lissa, Gu, Mulder, Rosseel, van Zundert, and Hoijtink (2020) for further elaborations.</p>
<ol style="list-style-type: lower-alpha">
<li>Bayesian confirmatory factor analysis</li>
<li>Bayesian latent regression</li>
<li>Bayesian multiple group latent regression. Note that, multiple group models with between group restrictions cannot be processed.</li>
</ol>
<p><strong>4. Examples Using a Named Vector</strong></p>
<p>If a <code>named vector</code> object is used, the main output table is labeled: “Bayesian informative hypothesis testing for an object of class numeric” (which denotes that <code>named vector</code> input was used).</p>
<ol style="list-style-type: lower-alpha">
<li>Bayesian ANOVA</li>
<li>Bayesian Welch’s ANOVA (unequal within group variances)</li>
<li>Bayesian robust (against non-normality) ANOVA (unequal within group variances)</li>
<li>Bayesian ANCOVA</li>
<li>Bayesian repeated measures analysis (one within factor)</li>
<li>Bayesian repeated measures analysis (within between design)</li>
<li>Bayesian one group logistic regression (counterpart of multiple regression)</li>
<li>Bayesian multiple group logistic regression (counterpart of ANCOVA)</li>
<li>Bayesian confirmatory factor analysis</li>
</ol>
<p><strong>1. Examples Using a <code>t_test</code> Object</strong></p>
<ol style="list-style-type: lower-alpha">
<li>An example of the Bayesian Student’s t-test (equal within group variances):</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load the bain package which includes the simulated sesamesim data set</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="co"># collect the data for the boys in the vector x and for the girls in the</span>
<span class="co"># vector y</span>
<span class="va">x</span><span class="op">&lt;-</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span>
<span class="va">y</span><span class="op">&lt;-</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span>
<span class="co"># execute student's t-test</span>
<span class="va">ttest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/t_test.html">t_test</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,paired <span class="op">=</span> <span class="cn">FALSE</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># set a seed value</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="co"># test hypotheses with bain. The names of the means are x and y.</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">ttest</span>, <span class="st">"x = y; x &gt; y; x &lt; y"</span><span class="op">)</span>
<span class="co"># display the results</span>
<span class="va">results</span>
<span class="co"># obtain the descriptives table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>An example of the Bayesian Welch’s t-test (unequal within group variances):</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load the bain package which includes the simulated sesamesim data set</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="co"># collect the data for the boys in the vector x and for the girs in the</span>
<span class="co"># vector y</span>
<span class="va">x</span><span class="op">&lt;-</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span>
<span class="va">y</span><span class="op">&lt;-</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span>
<span class="co"># execute student's t-test</span>
<span class="va">ttest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/t_test.html">t_test</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,paired <span class="op">=</span> <span class="cn">FALSE</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co"># set a seed value</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="co"># test hypotheses with bain. The names of the means are x and y.</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">ttest</span>, <span class="st">"x = y; x &gt; y; x &lt; y"</span><span class="op">)</span>
<span class="co"># display the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>
<span class="co"># obtain the descriptives table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>An example of the Bayesian paired samples t-test:</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load the bain package which includes the simulated sesamesim data set</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="co"># compare the pre with the post measurements</span>
<span class="va">ttest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/t_test.html">t_test</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">prenumb</span>,<span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span>,paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># set a seed value</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="co"># test hypotheses with bain. Use difference to refer to the difference between means</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">ttest</span>, <span class="st">"difference=0; difference&gt;0; difference&lt;0"</span><span class="op">)</span>
<span class="co"># display the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>
<span class="co"># obtain the descriptives table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<ol start="4" style="list-style-type: lower-alpha">
<li>An example of the Bayesian one group t-test:</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load the bain package which includes the simulated sesamesim data se</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="co"># compare post measurements with the reference value 30</span>
<span class="va">ttest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/t_test.html">t_test</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span><span class="op">)</span>
<span class="co"># Check name of estimate</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="co"># test hypotheses with bain versus the reference value 30. Use x to refer to the mean</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">ttest</span>, <span class="st">"x=30; x&gt;30; x&lt;30"</span><span class="op">)</span>
<span class="co"># display the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>
<span class="co"># obtain the descriptives table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<ol start="5" style="list-style-type: lower-alpha">
<li>An example of the Bayesian equivalence test</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load the bain package which includes the simulated sesamesim data set</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="co"># collect the data for the boys in the vector x and for the girs in the</span>
<span class="co"># vector y</span>
<span class="va">x</span><span class="op">&lt;-</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span>
<span class="va">y</span><span class="op">&lt;-</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span>
<span class="co"># execute student's t-test</span>
<span class="va">ttest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/t_test.html">t_test</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,paired <span class="op">=</span> <span class="cn">FALSE</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># compute the pooled within standard deviation using the variance of x</span>
<span class="co"># (ttest$v[1]) and y (ttest$v[2])</span>
<span class="va">pwsd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">ttest</span><span class="op">$</span><span class="va">v</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">ttest</span><span class="op">$</span><span class="va">v</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">/</span>
<span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co"># print pwsd in order to be able to include it in the hypothesis. Its value</span>
<span class="co"># is 12.60</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">pwsd</span><span class="op">)</span>
<span class="co"># set a seed value</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="co"># test hypotheses (the means of boy and girl differ less than .2 * pwsd =</span>
<span class="co"># 2.52 VERSUS the means differ more than .2 * pwsd = 2.52) with bain</span>
<span class="co"># note that, .2 is a value for Cohen's d reflecting a "small" effect, that</span>
<span class="co"># is, the means differ less or more than .2 pwsd.</span>
<span class="co"># use x and y to refer to the means.</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">ttest</span>, <span class="st">"x - y &gt; -2.52 &amp; x - y &lt; 2.52"</span><span class="op">)</span>
<span class="co"># display the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>
<span class="co"># obtain the descriptives table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<p><strong>2. Examples Using a <code>lm</code> Object</strong></p>
<ol style="list-style-type: lower-alpha">
<li>An example of the Bayesian ANOVA</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load the bain package which includes the simulated sesamesim data set</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="co"># make a factor of variable site</span>
<span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span><span class="op">)</span>
<span class="co"># execute an analysis of variance using lm() which, due to the -1, returns</span>
<span class="co"># estimates of the means per group</span>
<span class="va">anov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">postnumb</span><span class="op">~</span><span class="va">site</span><span class="op">-</span><span class="fl">1</span>,<span class="va">sesamesim</span><span class="op">)</span>
<span class="co"># take a look at the estimated means and their names</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">anov</span><span class="op">)</span>
<span class="co"># set a seed value</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="co"># test hypotheses with bain</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">anov</span>, <span class="st">"site1=site2=site3=site4=site5; site2&gt;site5&gt;site1&gt;
site3&gt;site4"</span><span class="op">)</span>
<span class="co"># display the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>
<span class="co"># obtain the descriptives table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>An example of the Bayesian ANCOVA</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load the bain package which includes the simulated sesamesim data se</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="co"># make a factor of variable site</span>
<span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span><span class="op">)</span>
<span class="co"># Center the covariate. If centered the coef() command below displays the</span>
<span class="co"># adjusted means. If not centered the intercepts are displayed.</span>
<span class="va">sesamesim</span><span class="op">$</span><span class="va">prenumb</span> <span class="op">&lt;-</span> <span class="va">sesamesim</span><span class="op">$</span><span class="va">prenumb</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">prenumb</span><span class="op">)</span>
<span class="co"># execute an analysis of covariance using lm() which, due to the -1, returns</span>
<span class="co"># estimates of the adjusted means per group</span>
<span class="va">ancov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">postnumb</span><span class="op">~</span><span class="va">site</span><span class="op">+</span><span class="va">prenumb</span><span class="op">-</span><span class="fl">1</span>,<span class="va">sesamesim</span><span class="op">)</span>
<span class="co"># take a look at the estimated adjusted means, the regression coefficient</span>
<span class="co"># of the covariate and their names</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">ancov</span><span class="op">)</span>
<span class="co"># set a seed value</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="co"># test hypotheses with bain</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">ancov</span>, <span class="st">"site1=site2=site3=site4=site5;
                        site2&gt;site5&gt;site1&gt;site3&gt;site4"</span><span class="op">)</span>
<span class="co"># display the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>
<span class="co"># obtain the descriptives table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>An example of the Bayesian multiple regression</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load the bain package which includes the simulated sesamesim data set</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="co"># execute a multiple regression using lm()</span>
<span class="va">regr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">postnumb</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">peabody</span> <span class="op">+</span> <span class="va">prenumb</span>,<span class="va">sesamesim</span><span class="op">)</span>
<span class="co"># take a look at the estimated regression coefficients and their names</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">regr</span><span class="op">)</span>
<span class="co"># set a seed value</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="co"># test hypotheses with bain. Note that standardize = FALSE denotes that the</span>
<span class="co"># hypotheses are in terms of unstandardized regression coefficients</span>
<span class="va">results</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">regr</span>, <span class="st">"age = 0 &amp; peab=0 &amp; pre=0 ; age &gt; 0 &amp; peab &gt; 0 &amp; pre &gt; 0"</span>
, standardize <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co"># display the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>
<span class="co"># obtain the descriptives table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>
<span class="co"># Since it is only meaningful to compare regression coefficients if they are</span>
<span class="co"># measured on the same scale, bain can also evaluate standardized regression</span>
<span class="co"># coefficients (based on the seBeta function by Jeff Jones and Niels Waller):</span>
<span class="co"># set a seed value</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="co"># test hypotheses with bain. Note that standardize = TRUE denotes that the</span>
<span class="co"># hypotheses are in terms of standardized regression coefficients</span>
<span class="va">results</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">regr</span>, <span class="st">"age = peab = pre ; pre &gt; age &gt; peab"</span>,standardize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># display the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>
<span class="co"># obtain the descriptives table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<ol start="4" style="list-style-type: lower-alpha">
<li>An example of the Bayesian ANOVA: Sensitivity Analysis</li>
</ol>
<p>Note that, most the code below can be replaced by a call to the function <code>bain_sensitivity</code>. See the help file for this function for further instructions (call <code><a href="../reference/bain_sensitivity.html">?bain_sensitivity</a></code>).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load the bain package which includes the simulated sesamesim data set</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="co"># make a factor of variable site</span>
<span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span><span class="op">)</span>
<span class="co"># execute an analysis of variance using lm() which, due to the -1, returns</span>
<span class="co"># estimates of the means per group</span>
<span class="va">anov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">postnumb</span><span class="op">~</span><span class="va">site</span><span class="op">-</span><span class="fl">1</span>,<span class="va">sesamesim</span><span class="op">)</span>
<span class="co"># take a look at the estimated means and their names</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">anov</span><span class="op">)</span>
<span class="co"># set a seed value</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="co"># test hypotheses with bain</span>
<span class="va">results1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">anov</span>, <span class="st">"site1=site2=site3=site4=site5; site2&gt;site5&gt;site1&gt;
site3&gt;site4"</span>, fraction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co"># display the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results1</span><span class="op">)</span>
<span class="co"># obtain the descriptives table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results1</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>
<span class="co"># execute a sensitivity analysis. See Hoijtink, Mulder, </span>
<span class="co"># van Lissa, and Gu (2019) for elaborations.</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="va">results2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">anov</span>, <span class="st">"site1=site2=site3=site4=site5; site2&gt;site5&gt;site1&gt;
site3&gt;site4"</span>,fraction <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="va">results3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">anov</span>, <span class="st">"site1=site2=site3=site4=site5; site2&gt;site5&gt;site1&gt;
site3&gt;site4"</span>,fraction <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results3</span><span class="op">)</span></code></pre></div>
<ol start="5" style="list-style-type: lower-alpha">
<li>An example of Bayesian Regression with missing data.</li>
</ol>
<p>RUNNING THIS EXAMPLE WILL TAKE ABOUT 60 SECONDS</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load the bain package which includes the simulated sesamesim data set</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>

<span class="co"># load mice (multiple imputation of missing data) </span>
<span class="co"># inspect the mice help file to obtain further information </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/amices/mice">mice</a></span><span class="op">)</span>

<span class="co"># create missing values in four variables from the sesamesim data set</span>
<span class="va">misdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html">cbind</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">prenumb</span>,<span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span>,<span class="va">sesamesim</span><span class="op">$</span><span class="va">funumb</span>,<span class="va">sesamesim</span><span class="op">$</span><span class="va">peabody</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">misdat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"prenumb"</span>,<span class="st">"postnumb"</span>,<span class="st">"funumb"</span>,<span class="st">"peabody"</span><span class="op">)</span>
<span class="va">misdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">misdat</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">pmis</span> <span class="op">&lt;-</span> <span class="fl">.80</span>
<span class="co">#</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">240</span><span class="op">)</span><span class="op">{</span>
  <span class="va">uni</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">pmis</span> <span class="op">&lt;</span> <span class="va">uni</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">misdat</span><span class="op">$</span><span class="va">funumb</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="cn">NA</span>
  <span class="op">}</span>
  <span class="va">uni</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">pmis</span> <span class="op">&lt;</span> <span class="va">uni</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">misdat</span><span class="op">$</span><span class="va">prenumb</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="cn">NA</span>
    <span class="va">misdat</span><span class="op">$</span><span class="va">postnumb</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="cn">NA</span>
  <span class="op">}</span>
  <span class="va">uni</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">pmis</span> <span class="op">&lt;</span> <span class="va">uni</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">misdat</span><span class="op">$</span><span class="va">peabody</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="cn">NA</span>
  <span class="op">}</span>
<span class="op">}</span>
<span class="co"># print data summaries - note the missing values (NAs)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">misdat</span><span class="op">)</span>

<span class="co"># use mice to create 1000 imputed data matrices. Note that, the approach used </span>
<span class="co"># below # is only one manner in which mice can be instructed. Many other </span>
<span class="co"># options are available.</span>
<span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">1000</span> 
<span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/mice.html">mice</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">misdat</span>, m <span class="op">=</span> <span class="va">M</span>, seed<span class="op">=</span><span class="fl">999</span>, meth<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"norm"</span>,<span class="st">"norm"</span>,<span class="st">"norm"</span>,<span class="st">"norm"</span><span class="op">)</span>, diagnostics <span class="op">=</span> <span class="cn">FALSE</span>, printFlag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># create vectors in which 1000 fits and complexities can be stored for each</span>
<span class="co"># of two hypotheses and their complement</span>
<span class="va">fits1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">"numeric"</span>,<span class="fl">1000</span><span class="op">)</span>
<span class="va">compls1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">"numeric"</span>,<span class="fl">1000</span><span class="op">)</span>
<span class="va">fits2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">"numeric"</span>,<span class="fl">1000</span><span class="op">)</span>
<span class="va">compls2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">"numeric"</span>,<span class="fl">1000</span><span class="op">)</span>
<span class="va">fitscomplement</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">"numeric"</span>,<span class="fl">1000</span><span class="op">)</span>
<span class="va">complscomplement</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">"numeric"</span>,<span class="fl">1000</span><span class="op">)</span>

<span class="co"># analyse each imputed data set with lm and bain, store the resulting</span>
<span class="co"># fits and complexities</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">M</span><span class="op">)</span> <span class="op">{</span>
<span class="va">regr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">funumb</span><span class="op">~</span><span class="va">prenumb</span><span class="op">+</span><span class="va">postnumb</span>,<span class="fu"><a href="https://amices.org/mice/reference/complete.mids.html">complete</a></span><span class="op">(</span><span class="va">out</span>,<span class="va">i</span><span class="op">)</span><span class="op">)</span>
<span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">regr</span>,<span class="st">"prenumb=0 &amp; postnumb=0;prenumb&gt;0 &amp; postnumb&gt;0"</span><span class="op">)</span>  
<span class="va">fits1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">result</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">Fit</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> 
<span class="va">compls1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">result</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">Com</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="va">fits2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">result</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">Fit</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> 
<span class="va">compls2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">result</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">Com</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
<span class="va">fitscomplement</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">result</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">Fit</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> 
<span class="va">complscomplement</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">result</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">Com</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>
<span class="op">}</span>

<span class="co"># compute the Bayes factor from the imputed fits and complexities</span>
<span class="co"># see Equation 23 in Hoijtink, H., Gu, X., Mulder, J., and Rosseel, Y. (2019). </span>
<span class="co"># Computing Bayes Factors from Data with Missing Values. </span>
<span class="co"># Psychological Methods, 24, 253-268. </span>

<span class="va">BF1u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">fits1</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">compls1</span><span class="op">)</span>
<span class="va">BF2u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">fits2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">compls2</span><span class="op">)</span>
<span class="va">BFcomplementu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">fitscomplement</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">complscomplement</span><span class="op">)</span>

<span class="co"># compute PMPc</span>
<span class="va">PMPcH1</span> <span class="op">&lt;-</span> <span class="va">BF1u</span><span class="op">/</span><span class="op">(</span><span class="va">BF1u</span> <span class="op">+</span> <span class="va">BF2u</span> <span class="op">+</span> <span class="va">BFcomplementu</span><span class="op">)</span>
<span class="va">PMPcH2</span> <span class="op">&lt;-</span> <span class="va">BF2u</span><span class="op">/</span><span class="op">(</span><span class="va">BF1u</span> <span class="op">+</span> <span class="va">BF2u</span> <span class="op">+</span> <span class="va">BFcomplementu</span><span class="op">)</span>
<span class="va">PMPcHcomplement</span> <span class="op">&lt;-</span> <span class="va">BFcomplementu</span><span class="op">/</span><span class="op">(</span><span class="va">BF1u</span> <span class="op">+</span> <span class="va">BF2u</span> <span class="op">+</span> <span class="va">BFcomplementu</span><span class="op">)</span></code></pre></div>
<p><strong>3. Examples Using a <code>lavaan</code> object</strong></p>
<ol style="list-style-type: lower-alpha">
<li>An example of Bayesian confirmatory factor analysis. See the tutorial by Van Lissa, Gu, Mulder, Rosseel, van Zundert, and Hoijtink (2020) for further elaborations.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load the bain and lavaan libraries. Visit www.lavaan.org for </span>
<span class="co"># lavaan mini-tutorials, examples, and elaborations</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be">lavaan</a></span><span class="op">)</span>

<span class="co">#  Specify and fit the confirmatory factor model</span>
<span class="va">model1</span> <span class="op">&lt;-</span> <span class="st">'
    A =~ Ab + Al + Af + An + Ar + Ac 
    B =~ Bb + Bl + Bf + Bn + Br + Bc 
'</span>
<span class="co"># Use the lavaan sem function to execute the confirmatory factor analysis</span>
<span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">model1</span>, data <span class="op">=</span> <span class="va">sesamesim</span>, std.lv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Inspect the parameter names</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span>

<span class="co"># Formulate hypotheses, call bain, obtain summary stats</span>
<span class="va">hypotheses1</span> <span class="op">&lt;-</span>
<span class="st">" A=~Ab &gt; .6 &amp; A=~Al &gt; .6 &amp; A=~Af &gt; .6 &amp; A=~An &gt; .6 &amp; A=~Ar &gt; .6 &amp; A=~Ac &gt;.6 &amp; 
B=~Bb &gt; .6 &amp; B=~Bl &gt; .6 &amp; B=~Bf &gt; .6 &amp; B=~Bn &gt; .6 &amp; B=~Br &gt; .6 &amp; B=~Bc &gt;.6"</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">fit1</span>,<span class="va">hypotheses1</span>,fraction<span class="op">=</span><span class="fl">1</span>,standardize<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">sy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">y</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>An example of Bayesian latent regression. See the tutorial by Van Lissa, Gu, Mulder, Rosseel, van Zundert, and Hoijtink (2020) for further elaborations.</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load the bain and lavaan libraries. Visit www.lavaan.org for </span>
<span class="co"># lavaan mini-tutorials, examples, and elaborations</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be">lavaan</a></span><span class="op">)</span>

<span class="co"># Specify and fit the latent regression model</span>
<span class="va">model2</span> <span class="op">&lt;-</span> <span class="st">'
    A  =~ Ab + Al + Af + An + Ar + Ac 
    B =~ Bb + Bl + Bf + Bn + Br + Bc

    A ~ B + age + peabody
'</span>
<span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">model2</span>, data <span class="op">=</span> <span class="va">sesamesim</span>, std.lv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Inspect the parameter names</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span>

<span class="co"># Formulate hypotheses, call bain, obtain summary stats</span>

<span class="va">hypotheses2</span> <span class="op">&lt;-</span> <span class="st">"A~B &gt; A~peabody = A~age = 0; 
               A~B &gt; A~peabody &gt; A~age = 0; 
A~B &gt; A~peabody &gt; A~age &gt; 0"</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">fit2</span>, <span class="va">hypotheses2</span>, fraction <span class="op">=</span> <span class="fl">1</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">sy1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">y1</span>, ci <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>An example of Bayesian multiple group regression. See the tutorial by Van Lissa, Gu, Mulder, Rosseel, van Zundert, and Hoijtink (2020) for further elaborations.</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load the bain and lavaan libraries. Visit www.lavaan.org for </span>
<span class="co"># lavaan mini-tutorials, examples, and elaborations</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be">lavaan</a></span><span class="op">)</span>

<span class="co"># Specify A multiple group regression model</span>
<span class="va">model3</span> <span class="op">&lt;-</span> <span class="st">'
    postnumb ~ prenumb + peabody 
'</span>
<span class="co"># Assign labels to the groups to be used when formulating</span>
<span class="co"># hypotheses</span>
<span class="va">sesamesim</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">sex</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"boy"</span>, <span class="st">"girl"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Fit the multiple group regression model</span>
<span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">model3</span>, data <span class="op">=</span> <span class="va">sesamesim</span>, std.lv <span class="op">=</span> <span class="cn">TRUE</span>, group <span class="op">=</span> <span class="st">"sex"</span><span class="op">)</span>
<span class="co"># Inspect the parameter names</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span>

<span class="co"># Formulate and evaluate the hypotheses</span>
<span class="va">hypotheses3</span> <span class="op">&lt;-</span>
<span class="st">"postnumb~prenumb.boy = postnumb~prenumb.girl &amp; postnumb~peabody.boy = postnumb~peabody.girl;
 postnumb~prenumb.boy &lt; postnumb~prenumb.girl &amp; postnumb~peabody.boy &lt; postnumb~peabody.girl
"</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">fit3</span>, <span class="va">hypotheses3</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">sy1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">y1</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<p><strong>4. Examples Using a named vector</strong></p>
<ol style="list-style-type: lower-alpha">
<li>An example of the Bayesian ANOVA using a named vector as input for bain</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load the bain package which includes the simulated sesamesim data se</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="co"># make a factor of variable site</span>
<span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span><span class="op">)</span>
<span class="co"># execute an analysis of variance using lm() which, due to the -1, returns</span>
<span class="co"># estimates of the means per group</span>
<span class="va">anov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">postnumb</span><span class="op">~</span><span class="va">site</span><span class="op">-</span><span class="fl">1</span>,<span class="va">sesamesim</span><span class="op">)</span>
<span class="co"># take a look at the estimated means and their names</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">anov</span><span class="op">)</span>
<span class="co"># collect the estimates means in a vector</span>
<span class="va">estimate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">anov</span><span class="op">)</span>
<span class="co"># give names to the estimates in anov</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"site1"</span>, <span class="st">"site2"</span>, <span class="st">"site3"</span>,<span class="st">"site4"</span>,<span class="st">"site5"</span><span class="op">)</span>
<span class="co"># create a vector containing the sample size of each group</span>
<span class="co"># (in case of missing values in the variables used, the command</span>
<span class="co"># below has to be modified such that only the cases without</span>
<span class="co"># missing values are counted)</span>
<span class="va">ngroup</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span><span class="op">)</span>
<span class="co"># compute for each group the covariance matrix of the parameters</span>
<span class="co"># of that group and collect these in a list</span>
<span class="co"># for the ANOVA this is simply a list containing for each group the variance</span>
<span class="co"># of the mean note that, the within group variance as estimated using lm is</span>
<span class="co"># used to compute the variance of each of the means! See, Hoijtink, Gu, and</span>
<span class="co"># Mulder (2019) for further elaborations.</span>
<span class="va">var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">anov</span><span class="op">)</span><span class="op">$</span><span class="va">sigma</span><span class="op">**</span><span class="fl">2</span>
<span class="va">cov1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">var</span><span class="op">/</span><span class="va">ngroup</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">cov2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">var</span><span class="op">/</span><span class="va">ngroup</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">cov3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">var</span><span class="op">/</span><span class="va">ngroup</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">cov4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">var</span><span class="op">/</span><span class="va">ngroup</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">cov5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">var</span><span class="op">/</span><span class="va">ngroup</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">covlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">cov1</span>, <span class="va">cov2</span>, <span class="va">cov3</span>, <span class="va">cov4</span>,<span class="va">cov5</span><span class="op">)</span>
<span class="co"># set a seed value</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="co"># test hypotheses with bain. Note that there are multiple groups</span>
<span class="co"># characterized by one mean, therefore group_parameters=0. Note that are no</span>
<span class="co"># joint parameters, therefore, joint_parameters=0.</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">estimate</span>,
<span class="st">"site1=site2=site3=site4=site5; site2&gt;site5&gt;site1&gt;site3&gt;site4"</span>,
n<span class="op">=</span><span class="va">ngroup</span>,Sigma<span class="op">=</span><span class="va">covlist</span>,group_parameters<span class="op">=</span><span class="fl">1</span>,joint_parameters <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co"># display the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>
<span class="co"># obtain the descriptives table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>An example of the Bayesian Welch’s ANOVA (that is an ANOVA that does not assume equal within group variances) using a named vector as input for bain</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load the bain library</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>

<span class="co"># make a factor of variable site</span>
<span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span><span class="op">)</span>

<span class="co"># collect the estimated means in a vector</span>
<span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span><span class="op">)</span>,<span class="va">mean</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>
<span class="co"># give names to the estimates</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"site1"</span>, <span class="st">"site2"</span>, <span class="st">"site3"</span>,<span class="st">"site4"</span>,<span class="st">"site5"</span><span class="op">)</span>

<span class="co"># create a vector containing the sample sizes of each group</span>
<span class="va">ngroup</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span><span class="op">)</span>

<span class="co"># compute the variances in each group and subquently the squared standard errors</span>
<span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span><span class="op">)</span>,<span class="va">var</span><span class="op">)</span>
<span class="va">vargroup</span> <span class="op">&lt;-</span> <span class="va">vars</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">ngroup</span>

<span class="co"># collect the variances of the means in a covariance listcov1 &lt;- matrix(vargroup[1], nrow=1, ncol=1)</span>
<span class="va">cov2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">vargroup</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">cov3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">vargroup</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">cov4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">vargroup</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">cov5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">vargroup</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">covlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">cov1</span>, <span class="va">cov2</span>, <span class="va">cov3</span>, <span class="va">cov4</span>,<span class="va">cov5</span><span class="op">)</span>

<span class="co"># set a seed value</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="co"># test hypotheses using bain. Note that there are multiple groups</span>
<span class="co"># characterized by one mean, therefore group_parameters=1. Note that</span>
<span class="co"># there are no joint parameters, therefore, joint_parameters=0.</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">estimates</span>,
                <span class="st">"site1=site2=site3=site4=site5;site2&gt;site5&gt;site1&gt;site4&gt;site3"</span>,
                n<span class="op">=</span><span class="va">ngroup</span>,Sigma<span class="op">=</span><span class="va">covlist</span>,group_parameters<span class="op">=</span><span class="fl">1</span>,joint_parameters <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>

<span class="co"># obtain the descriptives table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Bayesian robust (against non-normality) ANOVA (unequal within group variances). Robust ANOVA is elaborated in Bosman and Hoijtink (unpublished) which can be downloaded from the <code>bain</code> website.</li>
</ol>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load the bain package which includes the simulated sesamesim data set</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="co"># load the WRS2 package which renders the trimmed sample mean and</span>
<span class="co"># corresponding standard error</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">WRS2</span><span class="op">)</span>
<span class="co"># make a factor of variable site</span>
<span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span><span class="op">)</span>
<span class="co"># create a vector containing the sample sizes of each group</span>
<span class="co"># (in case of missing values in the variables used, the command</span>
<span class="co"># below has to be modified such that only the cases without</span>
<span class="co"># missing values are counted)</span>
<span class="va">ngroup</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span><span class="op">)</span>
<span class="co"># Compute the 20\% sample trimmed mean for each site</span>
<span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span><span class="op">[</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span>, tr <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,
               <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span><span class="op">[</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span>, tr <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,
               <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span><span class="op">[</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span>, tr <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,
               <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span><span class="op">[</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">==</span> <span class="fl">4</span><span class="op">]</span>, tr <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,
               <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span><span class="op">[</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">==</span> <span class="fl">5</span><span class="op">]</span>, tr <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>
<span class="co"># give names to the estimates</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"s1"</span>, <span class="st">"s2"</span>, <span class="st">"s3"</span>,<span class="st">"s4"</span>,<span class="st">"s5"</span><span class="op">)</span>
<span class="co"># display the estimates and their names</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span>
<span class="co"># Compute the sample trimmed mean standard error for each site</span>
<span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">trimse</span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span><span class="op">[</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
        <span class="fu">trimse</span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span><span class="op">[</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span><span class="op">)</span>,
        <span class="fu">trimse</span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span><span class="op">[</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span><span class="op">)</span>,
        <span class="fu">trimse</span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span><span class="op">[</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">==</span> <span class="fl">4</span><span class="op">]</span><span class="op">)</span>,
        <span class="fu">trimse</span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">postnumb</span><span class="op">[</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">==</span> <span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Square the standard errors to obtain the variances of the sample</span>
<span class="co"># trimmed means</span>
<span class="va">var</span> <span class="op">&lt;-</span> <span class="va">se</span><span class="op">^</span><span class="fl">2</span>
<span class="co"># Store the variances in a list of matrices</span>
<span class="va">covlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">var</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">var</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,
<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">var</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">var</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">var</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co"># set a seed value</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="co"># test hypotheses with bain</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">estimates</span>,<span class="st">"s1=s2=s3=s4=s5;s2&gt;s5&gt;s1&gt;s3&gt;s4"</span>,
n<span class="op">=</span><span class="va">ngroup</span>,Sigma<span class="op">=</span><span class="va">covlist</span>,group_parameters<span class="op">=</span><span class="fl">1</span>,joint_parameters<span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co"># display the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>
<span class="co"># obtain the descriptives table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<ol start="4" style="list-style-type: lower-alpha">
<li>An example of the Bayesian ANCOVA using a named vector as input for bain</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load the bain package which includes the simulated sesamesim data se</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="co"># make a factor of variable site</span>
<span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span><span class="op">)</span>
<span class="co"># center the covariate. If centered the coef() command below displays the</span>
<span class="co"># adjusted means. If not centered the intercepts are displayed.</span>
<span class="va">sesamesim</span><span class="op">$</span><span class="va">prenumb</span> <span class="op">&lt;-</span> <span class="va">sesamesim</span><span class="op">$</span><span class="va">prenumb</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">prenumb</span><span class="op">)</span>
<span class="co"># execute an analysis of covariance using lm() which, due to the -1, returns</span>
<span class="co"># estimates of the adjusted means per group</span>
<span class="va">ancov2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">postnumb</span><span class="op">~</span><span class="va">site</span><span class="op">+</span><span class="va">prenumb</span><span class="op">-</span><span class="fl">1</span>,<span class="va">sesamesim</span><span class="op">)</span>
<span class="co"># take a look at the estimated adjusted means and their names</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">ancov2</span><span class="op">)</span>
<span class="co"># collect the estimates of the adjusted means and regression coefficient of</span>
<span class="co"># the covariate in a vector (the vector has to contain first the</span>
<span class="co"># adjusted means and next the regression coefficients of the covariates)</span>
<span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">ancov2</span><span class="op">)</span>
<span class="co"># assign names to the estimates</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"v.1"</span>, <span class="st">"v.2"</span>, <span class="st">"v.3"</span>, <span class="st">"v.4"</span>,<span class="st">"v.5"</span>, <span class="st">"pre"</span><span class="op">)</span>
<span class="co"># compute the sample size per group</span>
<span class="co"># (in case of missing values in the variables used, the command</span>
<span class="co"># below has to be modified such that only the cases without</span>
<span class="co"># missing values are counted)</span>
<span class="va">ngroup</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span><span class="op">)</span>
<span class="co"># compute for each group the covariance matrix of the parameters of that</span>
<span class="co"># group and collect these in a list note that, the residual variance as</span>
<span class="co"># estimated using lm is used to compute these covariance matrices</span>
<span class="va">var</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ancov2</span><span class="op">)</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span>
<span class="co"># below, for each group, the covariance matrix of the adjusted mean and</span>
<span class="co"># covariate is computed</span>
<span class="co"># see Hoijtink, Gu, and Mulder (2019) for further explanation and elaboration</span>
<span class="va">cat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="fu"><a href="https://amices.org/mice/reference/cbind.html">cbind</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span>,<span class="va">sesamesim</span><span class="op">$</span><span class="va">prenumb</span><span class="op">)</span>, <span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">cat1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">cat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">cat1</span><span class="op">)</span>
<span class="va">cov1</span> <span class="op">&lt;-</span> <span class="va">var</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">cat1</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">cat1</span><span class="op">)</span>
<span class="co">#</span>
<span class="va">cat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="fu"><a href="https://amices.org/mice/reference/cbind.html">cbind</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span>,<span class="va">sesamesim</span><span class="op">$</span><span class="va">prenumb</span><span class="op">)</span>, <span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">cat2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">cat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">cat2</span><span class="op">)</span>
<span class="va">cov2</span> <span class="op">&lt;-</span> <span class="va">var</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">cat2</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">cat2</span><span class="op">)</span>
<span class="co">#</span>
<span class="va">cat3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="fu"><a href="https://amices.org/mice/reference/cbind.html">cbind</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span>,<span class="va">sesamesim</span><span class="op">$</span><span class="va">prenumb</span><span class="op">)</span>, <span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">cat3</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">cat3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">cat3</span><span class="op">)</span>
<span class="va">cov3</span> <span class="op">&lt;-</span> <span class="va">var</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">cat3</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">cat3</span><span class="op">)</span>
<span class="co">#</span>
<span class="va">cat4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="fu"><a href="https://amices.org/mice/reference/cbind.html">cbind</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span>,<span class="va">sesamesim</span><span class="op">$</span><span class="va">prenumb</span><span class="op">)</span>, <span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">cat4</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">cat4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">cat4</span><span class="op">)</span>
<span class="va">cov4</span> <span class="op">&lt;-</span> <span class="va">var</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">cat4</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">cat4</span><span class="op">)</span>
<span class="co">#</span>
<span class="va">cat5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="fu"><a href="https://amices.org/mice/reference/cbind.html">cbind</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span>,<span class="va">sesamesim</span><span class="op">$</span><span class="va">prenumb</span><span class="op">)</span>, <span class="va">sesamesim</span><span class="op">$</span><span class="va">site</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span>
<span class="va">cat5</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">cat5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">cat5</span><span class="op">)</span>
<span class="va">cov5</span> <span class="op">&lt;-</span> <span class="va">var</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">cat5</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">cat5</span><span class="op">)</span>
<span class="co">#</span>
<span class="va">covariances</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">cov1</span>, <span class="va">cov2</span>, <span class="va">cov3</span>, <span class="va">cov4</span>,<span class="va">cov5</span><span class="op">)</span>
<span class="co"># set a seed value</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="co"># test hypotheses with bain. Note that there are multiple groups</span>
<span class="co"># characterized by one adjusted mean, therefore group_parameters=1 Note that</span>
<span class="co"># there is one covariate, therefore, joint_parameters=1.</span>
<span class="va">results2</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">estimates</span>,<span class="st">"v.1=v.2=v.3=v.4=v.5;v.2 &gt; v.5 &gt; v.1 &gt; v.3 &gt;v.4;"</span>,
n<span class="op">=</span><span class="va">ngroup</span>,Sigma<span class="op">=</span><span class="va">covariances</span>,group_parameters<span class="op">=</span><span class="fl">1</span>,joint_parameters <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co"># display the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results2</span><span class="op">)</span>
<span class="co"># obtain the descriptives table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results2</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<ol start="5" style="list-style-type: lower-alpha">
<li>An example of the Bayesian one within factor repeated measures analysis</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load the bain package which includes the simulated sesamesim data set</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="co"># estimate the means of three repeated measures of number knowledge</span>
<span class="co"># the 1 denotes that these means have to be estimated</span>
<span class="va">within</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://amices.org/mice/reference/cbind.html">cbind</a></span><span class="op">(</span><span class="va">prenumb</span>,<span class="va">postnumb</span>,<span class="va">funumb</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, data<span class="op">=</span><span class="va">sesamesim</span><span class="op">)</span>
<span class="co"># take a look at the estimated means and their names</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">within</span><span class="op">)</span>
<span class="co"># note that the model specified in lm has three dependent variables.</span>
<span class="co"># Consequently, the estimates rendered by lm are collected in a "matrix".</span>
<span class="co"># Since bain needs a named vector containing the estimated means, the [1:3]</span>
<span class="co"># code is used to select the three means from a matrix and store them in a</span>
<span class="co"># vector.</span>
<span class="va">estimate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">within</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>
<span class="co"># give names to the estimates in anov</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pre"</span>, <span class="st">"post"</span>, <span class="st">"fu"</span><span class="op">)</span>
<span class="co"># compute the sample size</span>
<span class="co"># (in case of missing values in the variables used, the command</span>
<span class="co"># below has to be modified such that only the cases without</span>
<span class="co"># missing values are counted)</span>
<span class="va">ngroup</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">)</span>
<span class="co"># compute the covariance matrix of the three means</span>
<span class="va">covmatr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">within</span><span class="op">)</span><span class="op">)</span>
<span class="co"># set a seed value</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="co"># test hypotheses with bain. Note that there is one group, with three</span>
<span class="co"># means therefore group_parameters=3.</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">estimate</span>,<span class="st">"pre = post = fu; pre &lt; post &lt; fu"</span>, n<span class="op">=</span><span class="va">ngroup</span>,
Sigma<span class="op">=</span><span class="va">covmatr</span>, group_parameters<span class="op">=</span><span class="fl">3</span>, joint_parameters <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co"># display the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>
<span class="co"># obtain the descriptives table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<ol start="6" style="list-style-type: lower-alpha">
<li>An example of the Bayesian one between factor and one within factor repeated measures analysis</li>
</ol>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load the bain package which includes the simulated sesamesim data set</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="co"># make a factor of the variable sex</span>
<span class="va">sesamesim</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span>
<span class="co"># estimate the means of prenumb, postnumb, and funumb for boys and girls</span>
<span class="co"># the -1 denotes that the means have to estimated</span>
<span class="va">bw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://amices.org/mice/reference/cbind.html">cbind</a></span><span class="op">(</span><span class="va">prenumb</span>, <span class="va">postnumb</span>, <span class="va">funumb</span><span class="op">)</span><span class="op">~</span><span class="va">sex</span><span class="op">-</span><span class="fl">1</span>, data<span class="op">=</span><span class="va">sesamesim</span><span class="op">)</span>
<span class="co"># take a look at the estimated means and their names</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span>
<span class="co"># collect the estimated means in a vector</span>
<span class="va">est1</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="co"># the three means for sex = 1</span>
<span class="va">est2</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="co"># the three means for sex = 2</span>
<span class="va">estimate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">est1</span>,<span class="va">est2</span><span class="op">)</span>
<span class="co"># give names to the estimates in anov</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pre1"</span>, <span class="st">"post1"</span>, <span class="st">"fu1"</span>,<span class="st">"pre2"</span>, <span class="st">"post2"</span>, <span class="st">"fu2"</span><span class="op">)</span>
<span class="co"># determine the sample size per group</span>
<span class="co"># (in case of missing values in the variables used, the command</span>
<span class="co"># below has to be modified such that only the cases without</span>
<span class="co"># missing values are counted)</span>
<span class="va">ngroup</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span>
<span class="co"># cov1 has to contain the covariance matrix of the three means in group 1.</span>
<span class="co"># cov2 has to contain the covariance matrix in group 2</span>
<span class="co"># typing vcov(bw) in the console pane highlights the structure of</span>
<span class="co"># the covariance matrix of all 3+3=6 means</span>
<span class="co"># it has to be dissected in to cov1 and cov2</span>
<span class="va">cov1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span>,
<span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">5</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">3</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span>
<span class="va">cov1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">cov1</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>
<span class="va">cov2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">6</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span>,
<span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">6</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">6</span>,<span class="fl">4</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">bw</span><span class="op">)</span><span class="op">[</span><span class="fl">6</span>,<span class="fl">6</span><span class="op">]</span><span class="op">)</span>
<span class="va">cov2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">cov2</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>
<span class="va">covariance</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">cov1</span>,<span class="va">cov2</span><span class="op">)</span>
<span class="co"># set a seed value</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="co"># test hypotheses with bain. Note that there are multiple groups</span>
<span class="co"># characterized by three means, therefore group_parameters=3. Note that there</span>
<span class="co"># are no additional parameters, therefore, joint_parameters=0.</span>
<span class="va">results</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">estimate</span>, <span class="st">"pre1 - pre2 = post1 - post2 = fu1 -fu2;
pre1 - pre2 &gt; post1 - post2 &gt; fu1 -fu2"</span>  , n<span class="op">=</span><span class="va">ngroup</span>, Sigma<span class="op">=</span><span class="va">covariance</span>,
group_parameters<span class="op">=</span><span class="fl">3</span>, joint_parameters <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co"># display the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>
<span class="co"># obtain the descriptives table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<ol start="7" style="list-style-type: lower-alpha">
<li>An example of the Bayesian logistic regression as the counterpart of Bayesian multiple regression</li>
</ol>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load the bain package which includes the simulated sesamesim data set</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="co"># regression coefficients can only be mutually compared if the</span>
<span class="co"># corresponding predictors are measured on the same scale, therefore the</span>
<span class="co"># predictors are standardized</span>
<span class="va">sesamesim</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>
<span class="va">sesamesim</span><span class="op">$</span><span class="va">peabody</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">peabody</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">peabody</span><span class="op">)</span><span class="op">)</span><span class="op">/</span>
<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">peabody</span><span class="op">)</span>
<span class="va">sesamesim</span><span class="op">$</span><span class="va">prenumb</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">prenumb</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">prenumb</span><span class="op">)</span><span class="op">)</span><span class="op">/</span>
<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">prenumb</span><span class="op">)</span>
<span class="co"># estimate the logistic regression coefficients</span>
<span class="va">logreg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">viewenc</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">peabody</span> <span class="op">+</span> <span class="va">prenumb</span>, family<span class="op">=</span><span class="va">binomial</span>,
data<span class="op">=</span><span class="va">sesamesim</span><span class="op">)</span>
<span class="co"># take a look at the estimates and their names</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">logreg</span><span class="op">)</span>
<span class="co"># collect the estimated intercept and regression coefficients in a vector</span>
<span class="va">estimate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">logreg</span><span class="op">)</span>
<span class="co"># give names to the estimates</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"int"</span>, <span class="st">"age"</span>, <span class="st">"peab"</span> ,<span class="st">"pre"</span> <span class="op">)</span>
<span class="co"># compute the sample size. Note that, this is an analysis with ONE group</span>
<span class="co"># (in case of missing values in the variables used, the command</span>
<span class="co"># below has to be modified such that only the cases without</span>
<span class="co"># missing values are counted)</span>
<span class="va">ngroup</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">)</span>
<span class="co"># compute the covariance matrix of the intercept and regression coefficients</span>
<span class="va">covmatr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">logreg</span><span class="op">)</span><span class="op">)</span>
<span class="co"># set a seed value</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="co"># test hypotheses with bain. Note that there is one group, with four</span>
<span class="co"># parameters (intercept plus three regression coefficients) therefore</span>
<span class="co"># group_parameters=4.</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">estimate</span>, <span class="st">"age = peab = pre; age &gt; pre &gt; peab"</span>, n<span class="op">=</span><span class="va">ngroup</span>,
Sigma<span class="op">=</span><span class="va">covmatr</span>, group_parameters<span class="op">=</span><span class="fl">4</span>, joint_parameters <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co"># display the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>
<span class="co"># obtain the descriptives table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<ol start="8" style="list-style-type: lower-alpha">
<li>An example of the Bayesian logistic regression as the counterpart of an ANCOVA. This is Example 3 from Hoijtink, Gu, and Mulder (2019). The research question concerns the probability of encouragement to view sesame street (a dichotomous 0/1 meaning no/yes dependent variable) for boys (sex=1) and girls (sex=2) adjusted for their age. This is a kind of ANCOVA with a dichotomous instead of a continuous dependent variable.</li>
</ol>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load the bain package which includes the simulated sesamesim data set</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="co"># load the numDeriv package which will be used to compute the covariance</span>
<span class="co"># matrix of the adjusted group coefficients and regression coefficient of age</span>
<span class="co"># for the boys and the girls # using the estimates obtained using the data for </span>
<span class="co"># the boys AND the girls.</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://optimizer.r-forge.r-project.org/">numDeriv</a></span><span class="op">)</span>
<span class="co"># make a factor of the variable sex</span>
<span class="va">sesamesim</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span>
<span class="co"># center the covariate age</span>
<span class="va">sesamesim</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;-</span> <span class="va">sesamesim</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>
<span class="co"># determine sample size per sex group</span>
<span class="co"># (in case of missing values in the variables used, the command</span>
<span class="co"># below has to be modified such that only the cases without</span>
<span class="co"># missing values are counted)</span>
<span class="va">ngroup</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span>
<span class="co"># execute the logistic regression, -1 ensures that the coefficients</span>
<span class="co"># for boys and girl are estimated adjusted for the covariate age</span>
<span class="va">anal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">viewenc</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span> <span class="op">-</span> <span class="fl">1</span>, family<span class="op">=</span><span class="va">binomial</span>, data<span class="op">=</span><span class="va">sesamesim</span><span class="op">)</span>
<span class="co"># take a look at the estimates and their names</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">anal</span><span class="op">)</span>
<span class="co"># collect the estimates obtained using the data of the boys AND the</span>
<span class="co"># girls in a vector. This vector contains first the group specific</span>
<span class="co"># parameters followed by the regression coefficient of the covariate.</span>
<span class="va">estimates</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">anal</span><span class="op">)</span>
<span class="co"># give names to the estimates</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"boys"</span>, <span class="st">"girls"</span>, <span class="st">"age"</span><span class="op">)</span>
<span class="co"># use numDeriv to compute the Hessian matrix and subsequently the</span>
<span class="co"># covariance matrix for each of the two (boys and girls) groups.</span>
<span class="co"># The vector f should contain the regression coefficient of the group</span>
<span class="co"># at hand and the regression coefficient of the covariate.</span>
<span class="co">#</span>
<span class="co"># the first group</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="fu"><a href="https://amices.org/mice/reference/cbind.html">cbind</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">sex</span>,<span class="va">sesamesim</span><span class="op">$</span><span class="va">age</span>,<span class="va">sesamesim</span><span class="op">$</span><span class="va">viewenc</span><span class="op">)</span>,
<span class="va">sesamesim</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>
<span class="va">f</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">f</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">estimates</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># the regression coefficient of boys</span>
<span class="va">f</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">estimates</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="co"># the regression coefficient of age</span>
<span class="co">#</span>
<span class="co"># within the for loop below the log likelihood of the logistic</span>
<span class="co"># regression model is computed using the data for the boys</span>
<span class="va">logist1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">ngroup</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">{</span>
    <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">out</span> <span class="op">+</span> <span class="va">data</span><span class="op">[</span><span class="va">i</span>,<span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">data</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span>
    <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">data</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">hes1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/numDeriv/man/hessian.html">hessian</a></span><span class="op">(</span>func<span class="op">=</span><span class="va">logist1</span>, x<span class="op">=</span><span class="va">f</span><span class="op">)</span>
<span class="co"># multiply with -1 and invert to obtain the covariance matrix for the</span>
<span class="co"># first group</span>
<span class="va">cov1</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="va">hes1</span><span class="op">)</span>
<span class="co">#</span>
<span class="co"># the second group</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="fu"><a href="https://amices.org/mice/reference/cbind.html">cbind</a></span><span class="op">(</span><span class="va">sesamesim</span><span class="op">$</span><span class="va">sex</span>,<span class="va">sesamesim</span><span class="op">$</span><span class="va">age</span>,<span class="va">sesamesim</span><span class="op">$</span><span class="va">viewenc</span><span class="op">)</span>,
<span class="va">sesamesim</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span>
<span class="va">f</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">estimates</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="co"># the regression coefficient of girls</span>
<span class="va">f</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">estimates</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="co"># the regression coefficient of age</span>

<span class="co"># within the for loop below the log likelihood of the logistic</span>
<span class="co"># regression model is computed using the data for the girls</span>
<span class="va">logist2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">ngroup</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">{</span> 
    <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">out</span> <span class="op">+</span> <span class="va">data</span><span class="op">[</span><span class="va">i</span>,<span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">data</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span>
    <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">data</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">hes2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/numDeriv/man/hessian.html">hessian</a></span><span class="op">(</span>func<span class="op">=</span><span class="va">logist2</span>, x<span class="op">=</span><span class="va">f</span><span class="op">)</span>
<span class="co"># multiply with -1 and invert to obtain the covariance matrix</span>
<span class="va">cov2</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="va">hes2</span><span class="op">)</span>
<span class="co">#</span>
<span class="co">#make a list of covariance matrices</span>
<span class="va">covariance</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">cov1</span>,<span class="va">cov2</span><span class="op">)</span>
<span class="co">#</span>
<span class="co"># set a seed value</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="co"># test hypotheses with bain. Note that there are multiple groups</span>
<span class="co"># characterized by one adjusted group coefficient,</span>
<span class="co"># therefore group_parameters=1. Note that there is one covariate,</span>
<span class="co"># therefore, joint_parameters=1.</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span><span class="va">estimates</span>, <span class="st">"boys &lt; girls &amp; age &gt; 0"</span>, n<span class="op">=</span><span class="va">ngroup</span>,
Sigma<span class="op">=</span><span class="va">covariance</span>, group_parameters<span class="op">=</span><span class="fl">1</span>, joint_parameters <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co"># display the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>
<span class="co"># obtain the descriptives table</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<ol style="list-style-type: lower-roman">
<li>An example of Bayesian confirmatory factor analysis with a named vector object. This option uses <code>bain.default()</code>, so the user must manually extract the required information. See the tutorial by Van Lissa, Gu, Mulder, Rosseel, van Zundert, and Hoijtink (2020) for further elaborations. First, we fit a structural equation model using <code>lavaan</code>:</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://informative-hypotheses.sites.uu.nl/software/bain/">bain</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be">lavaan</a></span><span class="op">)</span>
<span class="va">model1</span> <span class="op">&lt;-</span> <span class="st">'A =~ Ab + Al + Af + An + Ar + Ac 
           B =~ Bb + Bl + Bf + Bn + Br + Bc'</span>
<span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">model1</span>, data <span class="op">=</span> <span class="va">sesamesim</span>, std.lv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>We want to specify the following hypotheses:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hypotheses</span> <span class="op">&lt;-</span> <span class="st">"(Ab, Al, Af, An, Ar, Ac) &gt;.6 &amp;
               (Bb, Bl, Bf, Bn, Br, Bc) &gt;.6"</span></code></pre></div>
<p>Next, we extract the required information from the <code>lavaan</code> model object, in the order of the parameter table above:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Extract standardized parameter estimates (argument x)</span>
<span class="va">PE1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/parameterEstimates.html">parameterEstimates</a></span><span class="op">(</span><span class="va">fit1</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># Identify which parameter estimates are factor loadings</span>
<span class="va">loadings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">PE1</span><span class="op">$</span><span class="va">op</span> <span class="op">==</span> <span class="st">"=~"</span><span class="op">)</span>
<span class="co"># Collect the standardized "std.all" factor loadings "=~"</span>
<span class="va">estimates</span> <span class="op">&lt;-</span> <span class="va">PE1</span><span class="op">$</span><span class="va">std.all</span><span class="op">[</span><span class="va">loadings</span><span class="op">]</span>
<span class="co"># Assign names to the standardized factor loadings</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ab"</span>, <span class="st">"Al"</span>, <span class="st">"Af"</span>, <span class="st">"An"</span>, <span class="st">"Ar"</span>, <span class="st">"Ac"</span>, 
                      <span class="st">"Bb"</span>, <span class="st">"Bl"</span>, <span class="st">"Bf"</span>, <span class="st">"Bn"</span>, <span class="st">"Br"</span>, <span class="st">"Bc"</span><span class="op">)</span>

<span class="co"># Extract sample size (argument n)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavaan-class.html">nobs</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span>

<span class="co"># Extract the standardized model parameter covariance matrix,</span>
<span class="co"># selecting only the rows and columns for the loadings</span>
<span class="va">covariance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html">lavInspect</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="st">"vcov.std.all"</span><span class="op">)</span><span class="op">[</span><span class="va">loadings</span>, <span class="va">loadings</span><span class="op">]</span>

<span class="co"># Give the covariance matrix the same names as the estimate</span>
<span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">covariance</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Put the covariance matrix in a list</span>
<span class="va">covariance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">covariance</span><span class="op">)</span>

<span class="co"># Specify number of group parameters; this simply means that there </span>
<span class="co"># are 12 parameters in the estimate.</span>
<span class="va">group_parameters</span> <span class="op">&lt;-</span> <span class="fl">12</span>

<span class="co"># Then, the number of joint parameters. This is always 0 for evaluations of</span>
<span class="co"># SEM hypotheses:</span>
<span class="va">joint_parameters</span> <span class="op">&lt;-</span> <span class="fl">0</span></code></pre></div>
<p>Now, we can evaluate the hypotheses using <code>bain.default()</code>:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bain.html">bain</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">estimates</span>,
            hypothesis <span class="op">=</span> <span class="va">hypotheses</span>,
            n <span class="op">=</span> <span class="va">n</span>,
            Sigma <span class="op">=</span> <span class="va">covariance</span>,
            group_parameters <span class="op">=</span> <span class="va">group_parameters</span>,
            joint_parameters <span class="op">=</span> <span class="va">joint_parameters</span><span class="op">)</span>
<span class="va">res</span></code></pre></div>
<p>Finally, we print the results of the bain analysis and obtain the estimates and 95% central credibility intervals</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>
<span class="va">sres</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Xin Gu, Herbert Hoijtink, Joris Mulder, Caspar J van Lissa.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
